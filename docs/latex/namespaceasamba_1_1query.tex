\hypertarget{namespaceasamba_1_1query}{}\section{asamba.\+query Namespace Reference}
\label{namespaceasamba_1_1query}\index{asamba.\+query@{asamba.\+query}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceasamba_1_1query_a64b71fbea43ff349dc4d813f35ffa459}{without\+\_\+constraint} (dbname, table, returned\+\_\+columns=\mbox{[}$\,$\mbox{]})
\item 
def \hyperlink{namespaceasamba_1_1query_abaf522b54d321283c1bdc7a688cfb9d2}{with\+\_\+constraints} (dbname, table, returned\+\_\+columns=\mbox{[}$\,$\mbox{]}, constraints\+\_\+keys=\mbox{[}$\,$\mbox{]}, constraints\+\_\+ranges=\mbox{[}$\,$\mbox{]})
\item 
def \hyperlink{namespaceasamba_1_1query_a57abe0b932be64cd2b91fc056a377143}{get\+\_\+tracks\+\_\+distinct\+\_\+\+M\+\_\+ini\+\_\+logD} ()
\item 
def \hyperlink{namespaceasamba_1_1query_ab496b3c36691cb77ea94156037f40f2a}{get\+\_\+models\+\_\+id\+\_\+from\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc} (M\+\_\+ini\+\_\+range, fov\+\_\+range, Z\+\_\+range, log\+D\+\_\+range, Xc\+\_\+range)
\item 
def \hyperlink{namespaceasamba_1_1query_a4fa47f5b2cb011771508b4305c159368}{get\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc\+\_\+from\+\_\+models\+\_\+id} (models\+\_\+ids)
\item 
def \hyperlink{namespaceasamba_1_1query_a3fb6d746d8c1dde610f066a9b319cc8f}{get\+\_\+log\+\_\+\+Teff\+\_\+log\+\_\+g\+\_\+from\+\_\+models\+\_\+id} (id\+\_\+model)
\item 
def \hyperlink{namespaceasamba_1_1query_abf11bd8e57ec89894fb8b23bef226d1d}{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot} (id\+\_\+model, id\+\_\+rot, id\+\_\+type=\mbox{[}$\,$\mbox{]}, freq\+\_\+range=\mbox{[}$\,$\mbox{]})
\item 
def \hyperlink{namespaceasamba_1_1query_a48eceec8dc6ed89e2916e155f3cd16a6}{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot\+\_\+prepared\+\_\+statement} (statement, id\+\_\+type=\mbox{[}$\,$\mbox{]}, freq\+\_\+range=\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{namespaceasamba_1_1query_a7178987eb523c25a790c9a4533e79367}\label{namespaceasamba_1_1query_a7178987eb523c25a790c9a4533e79367}} 
{\bfseries logger} = logging.\+get\+Logger(\+\_\+\+\_\+name\+\_\+\+\_\+)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}This module offers pre-composed queries to retrieve data from the database for a suite of 
recurring queries.
The outcome of most (if not all) of the routines in this module is basically the SQL query in 
string format. Therefore, external routines that call these functions just need to execute these
SQL querries.
\end{DoxyVerb}
 

\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceasamba_1_1query_a3fb6d746d8c1dde610f066a9b319cc8f}\label{namespaceasamba_1_1query_a3fb6d746d8c1dde610f066a9b319cc8f}} 
\index{asamba\+::query@{asamba\+::query}!get\+\_\+log\+\_\+\+Teff\+\_\+log\+\_\+g\+\_\+from\+\_\+models\+\_\+id@{get\+\_\+log\+\_\+\+Teff\+\_\+log\+\_\+g\+\_\+from\+\_\+models\+\_\+id}}
\index{get\+\_\+log\+\_\+\+Teff\+\_\+log\+\_\+g\+\_\+from\+\_\+models\+\_\+id@{get\+\_\+log\+\_\+\+Teff\+\_\+log\+\_\+g\+\_\+from\+\_\+models\+\_\+id}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{get\+\_\+log\+\_\+\+Teff\+\_\+log\+\_\+g\+\_\+from\+\_\+models\+\_\+id()}{get\_log\_Teff\_log\_g\_from\_models\_id()}}
{\footnotesize\ttfamily def asamba.\+query.\+get\+\_\+log\+\_\+\+Teff\+\_\+log\+\_\+g\+\_\+from\+\_\+models\+\_\+id (\begin{DoxyParamCaption}\item[{}]{id\+\_\+model }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the followng fixed query statement, ready to be executed:
@param id_model: The id of the model
@type id_model: integer
@return: The following SQL query is returned: "select log_Teff, log_g from models where id=?", where 
      the "?" is replaced internally by the id of the desired model.
@rtype: str
\end{DoxyVerb}
 

Definition at line 286 of file query.\+py.

\mbox{\Hypertarget{namespaceasamba_1_1query_a4fa47f5b2cb011771508b4305c159368}\label{namespaceasamba_1_1query_a4fa47f5b2cb011771508b4305c159368}} 
\index{asamba\+::query@{asamba\+::query}!get\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc\+\_\+from\+\_\+models\+\_\+id@{get\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc\+\_\+from\+\_\+models\+\_\+id}}
\index{get\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc\+\_\+from\+\_\+models\+\_\+id@{get\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc\+\_\+from\+\_\+models\+\_\+id}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{get\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc\+\_\+from\+\_\+models\+\_\+id()}{get\_M\_ini\_fov\_Z\_logD\_Xc\_from\_models\_id()}}
{\footnotesize\ttfamily def asamba.\+query.\+get\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc\+\_\+from\+\_\+models\+\_\+id (\begin{DoxyParamCaption}\item[{}]{models\+\_\+ids }\end{DoxyParamCaption})}

\begin{DoxyVerb}Retrieve the basic model/track attributes from the "tracks" and "models" tables in the database,
using the list of models.id attribute (input argument).

@param models_ids: an array of models ids
@type models_ids: list/tuple/ndarray of type np.int32 
@return: the query
@rtype: str
\end{DoxyVerb}
 

Definition at line 263 of file query.\+py.

\mbox{\Hypertarget{namespaceasamba_1_1query_ab496b3c36691cb77ea94156037f40f2a}\label{namespaceasamba_1_1query_ab496b3c36691cb77ea94156037f40f2a}} 
\index{asamba\+::query@{asamba\+::query}!get\+\_\+models\+\_\+id\+\_\+from\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc@{get\+\_\+models\+\_\+id\+\_\+from\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc}}
\index{get\+\_\+models\+\_\+id\+\_\+from\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc@{get\+\_\+models\+\_\+id\+\_\+from\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{get\+\_\+models\+\_\+id\+\_\+from\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc()}{get\_models\_id\_from\_M\_ini\_fov\_Z\_logD\_Xc()}}
{\footnotesize\ttfamily def asamba.\+query.\+get\+\_\+models\+\_\+id\+\_\+from\+\_\+\+M\+\_\+ini\+\_\+fov\+\_\+\+Z\+\_\+log\+D\+\_\+\+Xc (\begin{DoxyParamCaption}\item[{}]{M\+\_\+ini\+\_\+range,  }\item[{}]{fov\+\_\+range,  }\item[{}]{Z\+\_\+range,  }\item[{}]{log\+D\+\_\+range,  }\item[{}]{Xc\+\_\+range }\end{DoxyParamCaption})}

\begin{DoxyVerb}Retrieve the basic model/track attributes from the "tracks" and "models" tables in the database,
by providing the ranges in M_ini, fov, Z, logD and Xc, respectively.  

@param _range: the lower and upper range for searching the database for each parameter (both extremes
       inclusive).
@type _range: 2-element list of floats
@return: a SQL search/query string
@rtype: str
\end{DoxyVerb}
 

Definition at line 220 of file query.\+py.

\mbox{\Hypertarget{namespaceasamba_1_1query_a57abe0b932be64cd2b91fc056a377143}\label{namespaceasamba_1_1query_a57abe0b932be64cd2b91fc056a377143}} 
\index{asamba\+::query@{asamba\+::query}!get\+\_\+tracks\+\_\+distinct\+\_\+\+M\+\_\+ini\+\_\+logD@{get\+\_\+tracks\+\_\+distinct\+\_\+\+M\+\_\+ini\+\_\+logD}}
\index{get\+\_\+tracks\+\_\+distinct\+\_\+\+M\+\_\+ini\+\_\+logD@{get\+\_\+tracks\+\_\+distinct\+\_\+\+M\+\_\+ini\+\_\+logD}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{get\+\_\+tracks\+\_\+distinct\+\_\+\+M\+\_\+ini\+\_\+log\+D()}{get\_tracks\_distinct\_M\_ini\_logD()}}
{\footnotesize\ttfamily def asamba.\+query.\+get\+\_\+tracks\+\_\+distinct\+\_\+\+M\+\_\+ini\+\_\+logD (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}In the database, the range of \\f$log D\f$ values were selected as a function on initial mass, so that 
\f$\log D\f$ ranges between 0.0 and some \f$max(\log D)\f$ value in 5 discrete values; here, 
\f$ max(\log D)\f$ is a linear function of initial mass, as:

\f[ max(\log D_{\rm mix}) = \rm{offset} + \rm{slope}\, \times\, \log_{10}(M_{\rm ini}). 
\f]
where slope=\f$(6.5 - 2.5)/(\log_{10}(35) - \log_{10}(1.4))\f$, and the 
offset=\f$6.5-{\rm slope}\times\log_{10}(35)\f$, with 1.4 and 35 \f$M_{\odot}\f$ bening the lowest
and highest masses in the database, and \f$\log(D)=2.5\f$ and \f$\log(D)=6.5\f$ being the maximum logarithm
of diffusive mixing for the lowest and highest masses in the database, respectively.

This routine, prepares a simple query to retrieve all combinations of (M_ini, logD) for all tracks.
\end{DoxyVerb}
 

Definition at line 197 of file query.\+py.

\mbox{\Hypertarget{namespaceasamba_1_1query_abf11bd8e57ec89894fb8b23bef226d1d}\label{namespaceasamba_1_1query_abf11bd8e57ec89894fb8b23bef226d1d}} 
\index{asamba\+::query@{asamba\+::query}!modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot@{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot}}
\index{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot@{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot()}{modes\_from\_fixed\_id\_model\_id\_rot()}}
{\footnotesize\ttfamily def asamba.\+query.\+modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot (\begin{DoxyParamCaption}\item[{}]{id\+\_\+model,  }\item[{}]{id\+\_\+rot,  }\item[{}]{id\+\_\+type = {\ttfamily \mbox{[}\mbox{]}},  }\item[{}]{freq\+\_\+range = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the query statement to fetch mode information (i.e. id_model, id_rot, n, id_type, freq)
from the "modes" table given a fixed id_model and id_rot. This means, we basically deduce mode info
from one GYRE output file which now sits in the database.

@param id_model: the modes.id_model attribute from the "modes" table
@type id_model: int
@param id_rot: the modes.id_rot attribute from the "modes" table
@type id_rot: int
@param id_type: the list of mode identification types which are pre-defined in the grid.sql schema;
       e.g. radial modes (l, m) = (0, 0) correspond to id_type = [0], and radial prograde modes 
       correspond to [1]. Therefore, to inquire searching for radial AND dipole prograde modes, you
       must set id_types = [0, 1]
@type id_types: list of integer
@param freq_range: the lower and upper frequency range (Hz) to scan for, regardless of the id_type
@type freq_range: list
@return: the SQL query statement. the return rows from executing this statement will give the following
       output tuple per row: (id_model, id_rot, n, id_type, freq)
@rtype: str
\end{DoxyVerb}
 

Definition at line 313 of file query.\+py.

\mbox{\Hypertarget{namespaceasamba_1_1query_a48eceec8dc6ed89e2916e155f3cd16a6}\label{namespaceasamba_1_1query_a48eceec8dc6ed89e2916e155f3cd16a6}} 
\index{asamba\+::query@{asamba\+::query}!modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot\+\_\+prepared\+\_\+statement@{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot\+\_\+prepared\+\_\+statement}}
\index{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot\+\_\+prepared\+\_\+statement@{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot\+\_\+prepared\+\_\+statement}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot\+\_\+prepared\+\_\+statement()}{modes\_from\_fixed\_id\_model\_id\_rot\_prepared\_statement()}}
{\footnotesize\ttfamily def asamba.\+query.\+modes\+\_\+from\+\_\+fixed\+\_\+id\+\_\+model\+\_\+id\+\_\+rot\+\_\+prepared\+\_\+statement (\begin{DoxyParamCaption}\item[{}]{statement,  }\item[{}]{id\+\_\+type = {\ttfamily \mbox{[}\mbox{]}},  }\item[{}]{freq\+\_\+range = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the "prepared" query statement to fetch mode information (i.e. id_model, id_rot, n, id_type, 
freq) from the "modes" table given a fixed id_model and id_rot. This means, we basically deduce mode info
from one GYRE output file which now sits in the database.

@param statement: the name of the prepared statement, which is also used to execute the statement
@type statement: str
@param id_type: the list of mode identification types which are pre-defined in the grid.sql schema;
       e.g. radial modes (l, m) = (0, 0) correspond to id_type = [0], and radial prograde modes 
       correspond to [1]. Therefore, to inquire searching for radial AND dipole prograde modes, you
       must set id_types = [0, 1]
@type id_types: list of integer
@param freq_range: the lower and upper frequency range (Hz) to scan for, regardless of the id_type
@type freq_range: list
@return: the prepared statement and the execute statment, as a tuple of two elements
       The return rows from executing this statement will give the following
       output tuple per row: (id_model, id_rot, n, id_type, freq)
@rtype: tuple
\end{DoxyVerb}
 

Definition at line 367 of file query.\+py.

\mbox{\Hypertarget{namespaceasamba_1_1query_abaf522b54d321283c1bdc7a688cfb9d2}\label{namespaceasamba_1_1query_abaf522b54d321283c1bdc7a688cfb9d2}} 
\index{asamba\+::query@{asamba\+::query}!with\+\_\+constraints@{with\+\_\+constraints}}
\index{with\+\_\+constraints@{with\+\_\+constraints}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{with\+\_\+constraints()}{with\_constraints()}}
{\footnotesize\ttfamily def asamba.\+query.\+with\+\_\+constraints (\begin{DoxyParamCaption}\item[{}]{dbname,  }\item[{}]{table,  }\item[{}]{returned\+\_\+columns = {\ttfamily \mbox{[}\mbox{]}},  }\item[{}]{constraints\+\_\+keys = {\ttfamily \mbox{[}\mbox{]}},  }\item[{}]{constraints\+\_\+ranges = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Prepare a query to retrieve specific columns (from "returned_columns" argument) subject to the 
"WHERE" constraints specified by the "constraints_keys" argument, within the ranges specified in
"constraints_ranges" list. Therefore, this is a general-purpose routine that can be used on any 
database, with any table therein.

E.g. 
>>>my_query = with_constraints(dbname = 'grid', table = 'models',
                      returned_columns = ['id', 'Xc'], 
                      constraints_keys = ['log_Teff', 'log_g'], 
                      constraints_ranges = [[4,4.1], [3.4, 3.5]])
>>>with db_def.grid_db(dbname) as my_db: 
>>>  my_db.execute_one(my_query, None)
>>>  result = my_db.fetch_all()
>>>print len(results) > 0

Note: The order of items in the input arguments "constraints_keys" and "constraints_ranges" must 
match, because they are merged into a single SQL query in the same order as passed.

@param dbname: the name of the database to connect to
@type dbname: str
@param table: The name of the table where the query is going to be prepaired, and will be imosed on.
@type table: str
@param returned_columns: the list of column names that we require the values for in the output.
       E.g. one can set returned_columns = ['id', 'id_track', 'model_number'] to get the model id,
       the id of the evolutionary track that the model comes from, and the model_number of the model
       when this snapshot was stored by MESA. We check the requested column names exist as the 
       keys of the "models" table
@type returned_columns: list of strings
@param constraints_keys: the list of keys for which we impose constraints during the querying.
       E.g. constraints_keys = ['age', 'mass_conv_core']. Indeed, we check internally if the requested
       key is valid.
@type constrains_keys: list of strings   
@param constraints_ranges: The list which provides the list/tuple for the lower and higher range
       for each of the keys in the previous argument "constraints_keys". Note that the ranges are
       applied in the same order as the keys are passed, so that first key goes with first range,
       second key goes with the second range, and so on.
       E.g. for the two keys mentioned above, one may pass: 
       constraints_ranges = [(1e6, 5e6), (0.3, 0.5)]
@return: The query string which is ready to be used
@rtype: str
\end{DoxyVerb}
 

Definition at line 87 of file query.\+py.

\mbox{\Hypertarget{namespaceasamba_1_1query_a64b71fbea43ff349dc4d813f35ffa459}\label{namespaceasamba_1_1query_a64b71fbea43ff349dc4d813f35ffa459}} 
\index{asamba\+::query@{asamba\+::query}!without\+\_\+constraint@{without\+\_\+constraint}}
\index{without\+\_\+constraint@{without\+\_\+constraint}!asamba\+::query@{asamba\+::query}}
\subsubsection{\texorpdfstring{without\+\_\+constraint()}{without\_constraint()}}
{\footnotesize\ttfamily def asamba.\+query.\+without\+\_\+constraint (\begin{DoxyParamCaption}\item[{}]{dbname,  }\item[{}]{table,  }\item[{}]{returned\+\_\+columns = {\ttfamily \mbox{[}\mbox{]}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Prepare a query to retrieve specific columns (from "returned_columns" argument). This is a generic
routine that can be used on any table to retrive all rows from the table. A subset of columns can 
be selected for retrieval through the "returned_columns" argument. 

In fact, all this routine does is similar to the following generic SQL query:

  "SELECT * FROM table"

where the "*" can be optionally replaced with a user-specified list of strings giving the desired
column names of the table to retrieve.

@param dbname: the name of the database to connect to
@type dbname: str
@param table: The name of the table where the query is going to be prepaired, and will be imosed on.
@type table: str
@param returned_columns: the list of column names that we require the values for in the output.
       E.g. one can set returned_columns = ['id', 'id_track', 'model_number'] to get the model id,
       the id of the evolutionary track that the model comes from, and the model_number of the model
       when this snapshot was stored by MESA. We check the requested column names exist as the 
       keys of the "models" table
@type returned_columns: list of strings
@return: The query string which is ready to be used
@rtype: str
\end{DoxyVerb}
 

Definition at line 31 of file query.\+py.

